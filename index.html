<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="중등보카필수 단어 학습 앱">
    <meta name="keywords" content="영어단어, 학습앱, 중등보카, 단어암기">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="중등보카필수">
    <title>중등보카필수 - 단어 학습 앱</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#fee500">
</head>
<body>
    <div class="app-container">
        <!-- 모바일 메뉴 버튼 -->
        <button class="mobile-menu-btn" id="mobile-menu-btn" onclick="toggleMobileMenu()">
            <span></span>
            <span></span>
            <span></span>
        </button>
        
        <!-- 사이드바 -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h1>중등보카필수</h1>
                <p class="subtitle">단어 학습</p>
                <div class="user-info" id="userInfo">
                    <div class="current-user" id="currentUser">
                        <span id="userNameDisplay">사용자</span>
                        <button class="user-change-btn" onclick="showUserModal()" title="사용자 변경">👤</button>
                    </div>
                </div>
            </div>
            
            <!-- 사용자 선택 모달 -->
            <div class="user-modal" id="userModal" style="display: none;" onclick="if(event.target.id === 'userModal') closeUserModal()">
                <div class="user-modal-content" onclick="event.stopPropagation()">
                    <h3>사용자 선택</h3>
                    <input type="text" id="userNameInput" placeholder="이름을 입력하세요" maxlength="20" onkeypress="if(event.key === 'Enter') setUserName()">
                    <div class="user-modal-buttons">
                        <button onclick="setUserName()" class="user-save-btn">저장</button>
                        <button onclick="closeUserModal()" class="user-cancel-btn">취소</button>
                    </div>
                    <div class="user-list" id="userList">
                        <!-- 저장된 사용자 목록 -->
                    </div>
                </div>
            </div>
            
            <nav class="sidebar-nav">
                <button class="nav-item active" data-mode="speed">
                    <span>일일 단어</span>
                </button>
                <button class="nav-item" data-mode="list">
                    <span>단어리스트</span>
                </button>
                <button class="nav-item" data-mode="typing">
                    <span>타이핑 연습</span>
                </button>
                <button class="nav-item" data-mode="matching">
                    <span>매칭 게임</span>
                </button>
                <button class="nav-item" data-mode="stats">
                    <span>통계</span>
                </button>
                <button class="nav-item" data-mode="pdf">
                    <span>PDF 북 뷰어</span>
                </button>
            </nav>

            <div class="sidebar-footer">
                <div class="progress-summary">
                    <div class="progress-item">
                        <span>진행률</span>
                        <span id="overall-progress">0%</span>
                    </div>
                    <div class="progress-bar-mini">
                        <div id="overall-progress-bar" class="progress-fill-mini"></div>
                    </div>
                </div>
            </div>
        </aside>

        <!-- 메인 컨텐츠 -->
        <main class="main-content">
            <!-- 일일 단어 모드 (스피드 모드) -->
            <div id="speed-mode" class="mode-content active">
                <div class="speed-container">
                    <div class="speed-header">
                        <h2>일일 단어</h2>
                        <div class="day-selector-speed">
                            <label>일차 선택:</label>
                            <select id="speed-day-select">
                                <option value="1">DAY 1</option>
                            </select>
                            <button class="apply-day-btn" onclick="applySpeedDay()">적용</button>
                        </div>
                        <div class="day-progress-info">
                            <span>DAY <span id="current-day">1</span> / 100</span>
                            <span>진행: <span id="day-progress">0</span> / <span id="day-total">10</span></span>
                        </div>
                    </div>
                    <div class="speed-question" onclick="revealSpeedMeaning()">
                        <div class="speed-word" id="speed-word"></div>
                        <div class="speed-meaning-hidden" id="speed-meaning-hidden">
                            <div class="reveal-hint">클릭하여 뜻 보기</div>
                        </div>
                        <div class="speed-meaning" id="speed-meaning" style="display: none;"></div>
                    </div>
                    <div class="speed-options">
                        <button class="speed-btn wrong" onclick="speedAnswer(false)">모름</button>
                        <button class="speed-btn correct" onclick="speedAnswer(true)">알음</button>
                    </div>
                    <div class="speed-result" id="speed-result"></div>
                </div>
            </div>

            <!-- 단어 목록 모드 -->
            <div id="list-mode" class="mode-content">
                <div class="content-header">
                    <div class="day-selector">
                        <label>일차 선택:</label>
                        <select id="day-select">
                            <option value="">전체</option>
                        </select>
                    </div>
                    <div class="search-box">
                        <input type="text" id="word-search" placeholder="단어 검색...">
                    </div>
                </div>
                <div id="words-container" class="words-by-day"></div>
                <div class="study-complete-section" id="study-complete-section" style="display: none;">
                    <div class="complete-message">
                        <h3>🎉 학습 완료!</h3>
                        <p>이 일차의 단어 학습을 완료했습니다. 타이핑 연습으로 넘어가시겠습니까?</p>
                    </div>
                    <button class="next-study-btn" onclick="goToTypingPractice()">타이핑 연습 시작 →</button>
                </div>
            </div>

            <!-- 타이핑 연습 모드 -->
            <div id="typing-mode" class="mode-content">
                <div class="typing-container">
                    <div class="typing-header">
                        <h2>타이핑 연습</h2>
                        <div class="day-range-selector">
                            <label>일차 범위:</label>
                            <select id="typing-day-start">
                                <option value="1">1일차</option>
                            </select>
                            <span>~</span>
                            <select id="typing-day-end">
                                <option value="100">100일차</option>
                            </select>
                            <button class="apply-btn" onclick="applyTypingRange()">적용</button>
                        </div>
                        <div class="typing-stats">
                            <span>정확도: <span id="typing-accuracy">0%</span></span>
                            <span>속도: <span id="typing-speed">0</span> WPM</span>
                        </div>
                    </div>
                    <div class="typing-question">
                        <div class="meaning-display" id="typing-meaning"></div>
                        <div class="pos-display" id="typing-pos"></div>
                    </div>
                    <div class="typing-input-container">
                        <input type="text" id="typing-input" placeholder="영어 단어를 입력하고 Enter를 누르세요..." autocomplete="off">
                        <div class="typing-hint" id="typing-hint" style="display: none;"></div>
                    </div>
                    <div class="typing-result" id="typing-result"></div>
                    <div class="typing-action-buttons">
                        <button class="check-btn" onclick="checkTypingAnswer()">확인</button>
                        <button class="hint-btn" id="typing-hint-btn" onclick="showTypingHint()" style="display: none;">💡 힌트 보기</button>
                        <button class="answer-btn" id="typing-answer-btn" onclick="showTypingAnswer()" style="display: none;">👁️ 정답 보기</button>
                    </div>
                    <button class="next-btn" id="typing-next" style="display: none;">다시 시도</button>
                </div>
            </div>

            <!-- 매칭 게임 모드 -->
            <div id="matching-mode" class="mode-content">
                <div class="matching-container">
                    <div class="matching-header">
                        <h2>단어-뜻 매칭 게임</h2>
                        <div class="day-range-selector">
                            <label>일차 범위:</label>
                            <select id="matching-day-start">
                                <option value="1">1일차</option>
                            </select>
                            <span>~</span>
                            <select id="matching-day-end">
                                <option value="100">100일차</option>
                            </select>
                            <button class="apply-btn" onclick="applyMatchingRange()">적용</button>
                        </div>
                        <div class="matching-score">
                            <span>점수: <span id="matching-score">0</span></span>
                            <span>맞춘 개수: <span id="matching-count">0</span> / <span id="matching-total">10</span></span>
                        </div>
                    </div>
                    <div id="matching-board" class="matching-board"></div>
                    <button class="restart-btn" onclick="startMatchingGame()">새 게임 시작</button>
                </div>
            </div>

            <!-- 통계 모드 -->
            <div id="stats-mode" class="mode-content">
                <div class="stats-container-full">
                    <h2>학습 통계</h2>
                    <div class="stats-grid">
                        <div class="stat-box">
                            <div class="stat-icon">📚</div>
                            <div class="stat-value" id="stat-total-days">0</div>
                            <div class="stat-label">완료한 일차</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-icon">📝</div>
                            <div class="stat-value" id="stat-studied">0</div>
                            <div class="stat-label">학습한 단어</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-icon">⭐</div>
                            <div class="stat-value" id="stat-mastered">0</div>
                            <div class="stat-label">완벽히 암기</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-icon">🎯</div>
                            <div class="stat-value" id="stat-accuracy">0%</div>
                            <div class="stat-label">정확도</div>
                        </div>
                    </div>
                    <div class="day-progress-list" id="day-progress-list"></div>
                </div>
            </div>

            <!-- PDF 북 뷰어 모드 -->
            <div id="pdf-mode" class="mode-content">
                <div class="pdf-viewer-wrapper">
                    <div class="pdf-viewer-header">
                        <h2>PDF 북 뷰어</h2>
                        <div class="pdf-book-list" id="pdfBookList">
                            <!-- PDF 책 목록이 여기에 동적으로 추가됩니다 -->
                        </div>
                    </div>
                    <div class="pdf-viewer-container" id="pdfViewerContainer" style="display: none;">
                        <div class="pdf-viewer-header-bar">
                            <h3 id="pdfViewerTitle">PDF 뷰어</h3>
                            <button class="pdf-close-btn" onclick="closePDFViewer()">닫기</button>
                        </div>
                        <div class="pdf-viewer-content">
                            <button class="pdf-nav-btn pdf-prev-btn" id="pdfPrevBtn" onclick="pdfPrevPage()" disabled>‹</button>
                            <div class="pdf-page-wrapper">
                                <canvas id="pdfCanvas"></canvas>
                            </div>
                            <button class="pdf-nav-btn pdf-next-btn" id="pdfNextBtn" onclick="pdfNextPage()">›</button>
                        </div>
                        <div class="pdf-viewer-controls">
                            <button class="pdf-control-btn" onclick="pdfPrevPage()" id="pdfPrevBtnBottom">이전</button>
                            <div class="pdf-page-info">
                                <span id="pdfCurrentPage">1</span> / <span id="pdfTotalPages">1</span>
                            </div>
                            <button class="pdf-control-btn" onclick="pdfNextPage()" id="pdfNextBtnBottom">다음</button>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
    <!-- PDF.js 라이브러리 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script src="data.js"></script>
    <script src="app.js"></script>
    <script src="pdf-viewer.js"></script>
    
    <!-- Service Worker 등록 -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js')
                    .then((registration) => {
                        console.log('Service Worker 등록 성공:', registration.scope);
                    })
                    .catch((error) => {
                        console.log('Service Worker 등록 실패:', error);
                    });
            });
        }
    </script>
</body>
</html>
